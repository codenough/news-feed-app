@if (error()) {
  <div class="error-message">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <line x1="12" y1="8" x2="12" y2="12"/>
      <line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    <p>{{ error() }}</p>
    <button nz-button nzType="primary" (click)="onRefresh()">
      Retry
    </button>
  </div>
}

@if (isLoading()) {
  <div class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading articles...</p>
  </div>
}

@if (!isLoading() && !error() && articles().length === 0) {
  <div class="no-results-container">
    <svg class="no-results-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <circle cx="11" cy="11" r="8"/>
      <path d="m21 21-4.35-4.35"/>
      <line x1="11" y1="8" x2="11" y2="14"/>
      <line x1="8" y1="11" x2="14" y2="11"/>
    </svg>
    <h2 class="no-results-title">No articles found</h2>
    <p class="no-results-message">
      @if (searchQuery()) {
        No articles match your search "<strong>{{ searchQuery() }}</strong>".
      } @else if (currentFilter() === 'unread') {
        You have no unread articles.
      } @else if (currentFilter() === 'read') {
        You have no read articles yet.
      } @else if (currentFilter() === 'bookmarked') {
        You haven't bookmarked any articles yet.
      } @else {
        No articles available at the moment.
      }
    </p>
    @if (searchQuery() || currentFilter() !== 'all' || selectedSource()) {
      <button nz-button nzType="default" (click)="onClearFilters()">
        <span nz-icon nzType="close-circle" nzTheme="outline"></span>
        Clear filters
      </button>
    }
  </div>
}

@if (!isLoading() && !error() && articles().length > 0) {
  @for (group of articleGroups(); track group.date.getTime()) {
    <div class="article-group">
      <div class="group-header">
        <h2 class="group-title">{{ group.label }}</h2>
        @if (group.unreadCount > 0) {
          <nz-badge
            [nzCount]="group.unreadCount"
            [nzShowZero]="false"
            class="unread-count-badge"
          ></nz-badge>
        }
      </div>

      <div class="news-feed" [class.news-feed--list]="viewMode() === 'list'">
        @for (article of group.articles; track article.id) {
          <app-news-card
            [article]="article"
            [viewMode]="viewMode()"
            (cardClick)="onCardClick($event)"
            (bookmarkToggle)="onBookmarkToggle($event)"
            (readLaterToggle)="onReadLaterToggle($event)"
            (markRead)="onMarkRead($event)"
            (markUnread)="onMarkUnread($event)"
            (skip)="onSkip($event)"
            (undoSkip)="onUndoSkip($event)"
          />
        }
      </div>
    </div>
  }
}
